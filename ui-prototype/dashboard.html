<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requirement Tracker - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script> window.FontAwesomeConfig = { autoReplaceSvg: 'nest'};</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.3); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.5); }

        /* Custom animations */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse-soft { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        .animate-fade-in-up-delay-1 { animation: fadeInUp 0.5s ease-out 0.1s forwards; opacity: 0; }
        .animate-fade-in-up-delay-2 { animation: fadeInUp 0.5s ease-out 0.2s forwards; opacity: 0; }
        .animate-pulse-soft { animation: pulse-soft 2s ease-in-out infinite; }

        /* Smooth transitions */
        .transition-smooth { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        /* Glass morphism effect */
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
        .glass-dark { background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    },
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                            950: '#1e1b4b'
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75'
                        },
                        success: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            400: '#34d399',
                            500: '#10b981',
                            600: '#059669'
                        },
                        warning: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706'
                        },
                        danger: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626'
                        }
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'soft-lg': '0 10px 40px -15px rgba(0, 0, 0, 0.1)',
                        'glow': '0 0 20px rgba(99, 102, 241, 0.3)',
                        'glow-lg': '0 0 40px rgba(99, 102, 241, 0.2)'
                    }
                }
            }
        }
    </script>
</head>
<body class="font-sans antialiased bg-gradient-to-br from-slate-50 via-indigo-50/50 to-purple-50/50 min-h-screen">

<div id="main-app-container" class="layout-container h-screen relative flex flex-col overflow-hidden">

    <!-- Decorative background elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none -z-10">
        <div class="absolute -top-40 -left-40 w-[500px] h-[500px] bg-gradient-to-br from-primary-200/40 to-accent-200/30 rounded-full blur-3xl animate-pulse-soft"></div>
        <div class="absolute top-1/3 -right-32 w-[400px] h-[400px] bg-gradient-to-br from-accent-200/30 to-pink-200/30 rounded-full blur-3xl"></div>
        <div class="absolute -bottom-32 left-1/3 w-[450px] h-[450px] bg-gradient-to-br from-indigo-200/30 to-primary-200/30 rounded-full blur-3xl"></div>
        <!-- Grid pattern overlay -->
        <div class="absolute inset-0 bg-[linear-gradient(rgba(99,102,241,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(99,102,241,0.03)_1px,transparent_1px)] bg-[size:60px_60px]"></div>
    </div>

    <!-- Header -->
    <header id="header" class="z-20 glass border-b border-white/50 shadow-soft sticky top-0">
        <div class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-3 lg:py-4">
            <div class="flex items-center justify-between gap-4">
                <!-- Logo and Project Name -->
                <div class="flex items-center min-w-0 flex-1">
                    <div class="w-10 h-10 lg:w-11 lg:h-11 bg-gradient-to-br from-primary-500 via-primary-600 to-accent-600 rounded-xl flex items-center justify-center mr-3 shadow-glow flex-shrink-0">
                        <i class="fa-solid fa-clipboard-list text-white text-lg"></i>
                    </div>
                    <div class="min-w-0">
                        <div class="flex items-center gap-2">
                            <span id="project-name-display" class="text-base lg:text-lg font-bold text-gray-800 truncate max-w-[200px] sm:max-w-[300px] lg:max-w-none">Test</span>
                            <input id="project-name-input" type="text" class="hidden text-base lg:text-lg font-bold text-gray-800 border-2 border-primary-500 rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-primary-200" maxlength="100">
                            <button id="edit-project-name-btn" class="text-gray-400 hover:text-primary-600 transition-colors p-1.5 hover:bg-primary-50 rounded-lg flex-shrink-0">
                                <i class="fa-solid fa-pen text-xs"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Desktop Actions -->
                <div class="hidden md:flex items-center gap-2 lg:gap-3">
                    <button id="show-hide-effort-btn" class="px-3 lg:px-4 py-2 bg-white/80 border border-gray-200 rounded-xl text-gray-700 hover:bg-white hover:border-gray-300 hover:shadow-soft transition-smooth flex items-center gap-2 text-sm font-medium">
                        <i class="fa-solid fa-eye text-gray-500"></i>
                        <i class="fa-solid fa-eye-slash text-gray-500 hidden"></i>
                        <span class="hidden lg:inline">Hide Effort</span>
                    </button>

                    <button id="export-btn" class="px-3 lg:px-4 py-2 bg-white/80 border border-gray-200 rounded-xl text-gray-700 hover:bg-white hover:border-gray-300 hover:shadow-soft transition-smooth flex items-center gap-2 text-sm font-medium">
                        <i class="fa-solid fa-download text-primary-500"></i>
                        <span class="hidden lg:inline">Export</span>
                    </button>

                    <button id="import-btn" class="px-3 lg:px-4 py-2 bg-white/80 border border-gray-200 rounded-xl text-gray-700 hover:bg-white hover:border-gray-300 hover:shadow-soft transition-smooth flex items-center gap-2 text-sm font-medium">
                        <i class="fa-solid fa-upload text-primary-500"></i>
                        <span class="hidden lg:inline">Import</span>
                    </button>

                    <button id="new-project-btn" class="px-4 lg:px-5 py-2 bg-gradient-to-r from-primary-600 to-accent-600 text-white rounded-xl hover:from-primary-700 hover:to-accent-700 transition-smooth flex items-center gap-2 text-sm font-semibold shadow-glow hover:shadow-glow-lg">
                        <i class="fa-solid fa-plus"></i>
                        <span>New Project</span>
                    </button>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                    <i class="fa-solid fa-ellipsis-vertical text-lg"></i>
                </button>
            </div>

            <!-- Mobile Actions (hidden by default) -->
            <div id="mobile-actions" class="hidden md:hidden mt-3 pt-3 border-t border-gray-200/50 grid grid-cols-2 gap-2">
                <button id="show-hide-effort-btn-mobile" class="px-3 py-2.5 bg-white/80 border border-gray-200 rounded-xl text-gray-700 flex items-center justify-center gap-2 text-sm font-medium">
                    <i class="fa-solid fa-eye text-gray-500"></i>
                    <i class="fa-solid fa-eye-slash text-gray-500 hidden"></i>
                    <span>Hide Effort</span>
                </button>
                <button id="export-btn-mobile" class="px-3 py-2.5 bg-white/80 border border-gray-200 rounded-xl text-gray-700 flex items-center justify-center gap-2 text-sm font-medium">
                    <i class="fa-solid fa-download text-primary-500"></i>
                    <span>Export</span>
                </button>
                <button id="import-btn-mobile" class="px-3 py-2.5 bg-white/80 border border-gray-200 rounded-xl text-gray-700 flex items-center justify-center gap-2 text-sm font-medium">
                    <i class="fa-solid fa-upload text-primary-500"></i>
                    <span>Import</span>
                </button>
                <button id="new-project-btn-mobile" class="px-3 py-2.5 bg-gradient-to-r from-primary-600 to-accent-600 text-white rounded-xl flex items-center justify-center gap-2 text-sm font-semibold">
                    <i class="fa-solid fa-plus"></i>
                    <span>New Project</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="relative z-10 flex-1 w-full flex flex-col min-h-0">
        <div class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8 flex-1 flex flex-col w-full min-h-0">

            <!-- Dashboard Grid Layout -->
            <div class="grid grid-cols-1 xl:grid-cols-12 gap-6 lg:gap-8 flex-1 min-h-0">

                <!-- Main Content Column (8 cols on xl) -->
                <div class="xl:col-span-8 flex flex-col min-h-0">

                    <!-- Requirements List Section -->
                    <section id="requirements-list-section" class="animate-fade-in-up flex-1 flex flex-col min-h-0">
                        <div class="glass rounded-2xl lg:rounded-3xl shadow-soft-lg border border-white/60 overflow-hidden flex-1 flex flex-col">
                            <!-- Section Header -->
                            <div class="px-5 py-4 lg:px-6 lg:py-5 border-b border-gray-100/80 bg-gradient-to-r from-white/50 to-transparent">
                                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 lg:w-11 lg:h-11 bg-gradient-to-br from-primary-100 to-primary-200 rounded-xl flex items-center justify-center mr-3 shadow-soft">
                                            <i class="fa-solid fa-list-check text-primary-600 text-sm lg:text-base"></i>
                                        </div>
                                        <div>
                                            <h2 class="text-lg lg:text-xl font-bold text-gray-800">Requirements List</h2>
                                            <p class="text-xs lg:text-sm text-gray-500 mt-0.5">
                                                <span id="total-requirements-count" class="font-semibold text-gray-700">0</span> total requirements
                                            </p>
                                        </div>
                                    </div>

                                    <!-- Status Badges -->
                                    <div class="flex items-center gap-3 sm:gap-4">
                                        <div class="flex items-center gap-2 px-3 py-1.5 bg-success-50 rounded-full">
                                            <div class="w-2 h-2 bg-success-500 rounded-full animate-pulse"></div>
                                            <span class="text-xs font-semibold text-success-600"><span id="active-count">0</span> Active</span>
                                        </div>
                                        <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-full">
                                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                            <span class="text-xs font-semibold text-gray-600"><span id="inactive-count">0</span> Inactive</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Table Container -->
                            <div id="requirements-table-container" class="overflow-x-auto flex-1 overflow-y-auto">
                                <table class="w-full">
                                    <thead class="bg-gradient-to-r from-gray-50/95 to-gray-50/90 sticky top-0 z-10 backdrop-blur-sm shadow-sm">
                                        <tr>
                                            <th class="px-5 lg:px-6 py-3.5 text-left text-xs font-bold text-gray-500 uppercase tracking-wider w-24">
                                                <div class="flex items-center gap-2">
                                                    <i class="fa-solid fa-toggle-on text-primary-400"></i>
                                                    Status
                                                </div>
                                            </th>
                                            <th class="px-5 lg:px-6 py-3.5 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                                                <div class="flex items-center gap-2">
                                                    <i class="fa-solid fa-file-lines text-primary-400"></i>
                                                    Description
                                                </div>
                                            </th>
                                            <th id="effort-column-header" class="px-5 lg:px-6 py-3.5 text-left text-xs font-bold text-gray-500 uppercase tracking-wider w-28">
                                                <div class="flex items-center gap-2">
                                                    <i class="fa-solid fa-clock text-accent-400"></i>
                                                    Effort
                                                </div>
                                            </th>
                                            <th class="px-5 lg:px-6 py-3.5 text-right text-xs font-bold text-gray-500 uppercase tracking-wider w-40">
                                                <div class="flex items-center justify-end gap-2">
                                                    <i class="fa-solid fa-wrench text-gray-400"></i>
                                                    Actions
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="requirements-tbody" class="divide-y divide-gray-100">
                                    </tbody>
                                </table>
                            </div>

                            <!-- Empty State -->
                            <div id="empty-state" class="px-6 py-12 lg:py-16 text-center">
                                <div class="inline-flex items-center justify-center w-20 h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-gray-100 to-gray-200/80 rounded-2xl mb-5 shadow-soft">
                                    <i class="fa-solid fa-inbox text-gray-400 text-3xl lg:text-4xl"></i>
                                </div>
                                <h3 class="text-lg lg:text-xl font-bold text-gray-800 mb-2">No requirements yet</h3>
                                <p class="text-sm lg:text-base text-gray-500 max-w-md mx-auto">Add your first requirement below to get started tracking your project.</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Sidebar Column (4 cols on xl) -->
                <div class="xl:col-span-4 space-y-6 lg:space-y-8 overflow-y-auto">

                    <!-- Effort Summary Card -->
                    <section id="total-effort-section" class="animate-fade-in-up-delay-2">
                        <div class="relative overflow-hidden rounded-2xl lg:rounded-3xl shadow-soft-lg">
                            <!-- Gradient Background -->
                            <div class="absolute inset-0 bg-gradient-to-br from-primary-600 via-primary-700 to-accent-700"></div>
                            <!-- Pattern Overlay -->
                            <div class="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(255,255,255,0.15)_0%,transparent_50%)]"></div>
                            <div class="absolute inset-0 bg-[radial-gradient(circle_at_80%_80%,rgba(255,255,255,0.1)_0%,transparent_40%)]"></div>

                            <div class="relative p-5 lg:p-6 text-white">
                                <!-- Header -->
                                <div class="flex items-center gap-3 mb-5">
                                    <div class="w-11 h-11 lg:w-12 lg:h-12 bg-white/20 backdrop-blur-lg rounded-xl flex items-center justify-center">
                                        <i class="fa-solid fa-chart-line text-white text-lg lg:text-xl"></i>
                                    </div>
                                    <h3 class="text-lg lg:text-xl font-bold">Effort Summary</h3>
                                </div>

                                <!-- Total Effort -->
                                <div>
                                    <p class="text-white/70 text-xs lg:text-sm font-medium uppercase tracking-wider mb-1">Total Active Effort</p>
                                    <p id="total-effort-display" class="text-4xl lg:text-5xl font-extrabold tracking-tight">0.00</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Add Requirement Section -->
                    <section id="add-requirement-section" class="animate-fade-in-up-delay-3">
                        <div class="glass rounded-2xl lg:rounded-3xl shadow-soft-lg p-5 lg:p-6 border border-white/60">
                            <!-- Section Header -->
                            <div class="flex items-center mb-5">
                                <div class="w-10 h-10 lg:w-11 lg:h-11 bg-gradient-to-br from-primary-500 to-accent-500 rounded-xl flex items-center justify-center mr-3 shadow-glow">
                                    <i class="fa-solid fa-plus text-white text-sm lg:text-base"></i>
                                </div>
                                <div>
                                    <h2 class="text-lg lg:text-xl font-bold text-gray-800">Add New Requirement</h2>
                                    <p class="text-xs lg:text-sm text-gray-500 mt-0.5">Fill in the details below</p>
                                </div>
                            </div>

                            <!-- Form - Single Column Layout for Sidebar -->
                            <div class="space-y-4">
                                <!-- Description Field -->
                                <div>
                                    <label for="requirement-description" class="text-xs lg:text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1.5">
                                        <i class="fa-solid fa-file-lines text-primary-500 text-xs"></i>
                                        Requirement Description
                                        <span class="text-danger-500">*</span>
                                    </label>
                                    <div class="relative">
                                        <textarea
                                            id="requirement-description"
                                            rows="3"
                                            class="w-full px-4 py-3 text-sm lg:text-base border-2 border-gray-200/80 rounded-xl focus:outline-none focus:border-primary-400 focus:ring-4 focus:ring-primary-100 transition-smooth bg-white/70 backdrop-blur-sm resize-none placeholder:text-gray-400"
                                            placeholder="Enter requirement description..."
                                            maxlength="500"
                                        ></textarea>
                                        <div class="absolute bottom-2.5 right-3 text-xs text-gray-400 font-medium bg-white/80 px-1.5 py-0.5 rounded">
                                            <span id="desc-char-count">0</span>/500
                                        </div>
                                    </div>
                                    <div id="description-error" class="hidden mt-2 p-3 bg-danger-50 border border-danger-200 rounded-xl">
                                        <div class="flex items-center gap-2">
                                            <i class="fa-solid fa-circle-exclamation text-danger-500 text-sm"></i>
                                            <span id="description-error-text" class="text-xs lg:text-sm text-danger-700 font-medium"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Effort Field -->
                                <div>
                                    <label for="effort-value" class="text-xs lg:text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1.5">
                                        <i class="fa-solid fa-clock text-accent-500 text-xs"></i>
                                        Effort
                                        <span class="text-danger-500">*</span>
                                    </label>
                                    <input
                                        type="number"
                                        id="effort-value"
                                        step="0.01"
                                        min="0"
                                        max="9999"
                                        class="w-full px-4 py-3 text-sm lg:text-base border-2 border-gray-200/80 rounded-xl focus:outline-none focus:border-accent-400 focus:ring-4 focus:ring-accent-100 transition-smooth bg-white/70 backdrop-blur-sm placeholder:text-gray-400"
                                        placeholder="e.g., 5.5"
                                    />
                                    <div id="effort-error" class="hidden mt-2 p-3 bg-danger-50 border border-danger-200 rounded-xl">
                                        <div class="flex items-center gap-2">
                                            <i class="fa-solid fa-circle-exclamation text-danger-500 text-sm"></i>
                                            <span id="effort-error-text" class="text-xs lg:text-sm text-danger-700 font-medium"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Add Button -->
                                <button
                                    id="add-requirement-btn"
                                    class="w-full py-3 lg:py-3.5 px-5 bg-gradient-to-r from-primary-600 via-primary-600 to-accent-600 hover:from-primary-700 hover:via-primary-700 hover:to-accent-700 text-white font-semibold text-sm lg:text-base rounded-xl shadow-glow hover:shadow-glow-lg transform hover:scale-[1.02] active:scale-[0.98] transition-smooth flex items-center justify-center gap-2"
                                >
                                    <i class="fa-solid fa-plus"></i>
                                    <span>Add</span>
                                </button>
                            </div>
                        </div>
                    </section>

                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->

</div>

<!-- New Project Confirmation Modal -->
<div id="confirmation-modal" class="hidden fixed inset-0 bg-gray-900/60 backdrop-blur-md z-50 items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="new-project-modal-title">
    <div class="bg-white rounded-2xl lg:rounded-3xl shadow-2xl max-w-md w-full p-6 lg:p-8 transform transition-all animate-fade-in-up">
        <div class="flex items-start gap-4 mb-6">
            <div class="w-12 h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-warning-100 to-warning-200 rounded-xl lg:rounded-2xl flex items-center justify-center flex-shrink-0 shadow-soft">
                <i class="fa-solid fa-exclamation-triangle text-warning-600 text-xl lg:text-2xl" aria-hidden="true"></i>
            </div>
            <div>
                <h3 id="new-project-modal-title" class="text-lg lg:text-xl font-bold text-gray-800 mb-2">Start New Project?</h3>
                <p class="text-sm lg:text-base text-gray-600 leading-relaxed">This will clear all current requirements and data. Make sure you've exported your data if needed.</p>
            </div>
        </div>
        <div class="flex gap-3">
            <button id="cancel-new-project" class="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-xl transition-smooth">
                Cancel
            </button>
            <button id="confirm-new-project" class="flex-1 px-4 py-3 bg-gradient-to-r from-danger-500 to-danger-600 hover:from-danger-600 hover:to-danger-700 text-white font-semibold rounded-xl transition-smooth shadow-soft hover:shadow-soft-lg">
                Yes, Start New
            </button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-confirmation-modal" style="display: none;" class="fixed inset-0 bg-gray-900/60 backdrop-blur-md z-50 flex items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title">
    <div class="bg-white rounded-2xl lg:rounded-3xl shadow-2xl max-w-md w-full p-6 lg:p-8 transform transition-all animate-fade-in-up">
        <div class="flex items-start gap-4 mb-6">
            <div class="w-12 h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-danger-100 to-danger-200 rounded-xl lg:rounded-2xl flex items-center justify-center flex-shrink-0 shadow-soft">
                <i class="fa-solid fa-trash text-danger-600 text-xl lg:text-2xl" aria-hidden="true"></i>
            </div>
            <div>
                <h3 id="delete-modal-title" class="text-lg lg:text-xl font-bold text-gray-800 mb-2">Delete Requirement?</h3>
                <p class="text-sm lg:text-base text-gray-600 leading-relaxed">This action cannot be undone. The requirement will be permanently removed.</p>
            </div>
        </div>
        <div class="flex gap-3">
            <button id="cancel-delete-requirement" class="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-xl transition-smooth">
                Cancel
            </button>
            <button id="confirm-delete-requirement" class="flex-1 px-4 py-3 bg-danger-600 hover:bg-danger-700 text-white font-semibold rounded-xl transition-all duration-200 shadow-soft hover:shadow-lg transform hover:scale-105 active:scale-95">
                Yes, Delete
            </button>
        </div>
    </div>
</div>

<input type="file" id="import-file-input" accept=".json,.csv" class="hidden">

<script>
window.addEventListener('load', function() {
    let requirements = [];
    let currentEditId = null;
    let currentDeleteId = null;
    let effortColumnVisible = true;
    
    const projectNameDisplay = document.getElementById('project-name-display');
    const projectNameInput = document.getElementById('project-name-input');
    const editProjectNameBtn = document.getElementById('edit-project-name-btn');
    const requirementDescription = document.getElementById('requirement-description');
    const effortValue = document.getElementById('effort-value');
    const addRequirementBtn = document.getElementById('add-requirement-btn');
    const requirementsTbody = document.getElementById('requirements-tbody');
    const emptyState = document.getElementById('empty-state');
    const totalEffortDisplay = document.getElementById('total-effort-display');
    const totalRequirementsCount = document.getElementById('total-requirements-count');
    const activeCount = document.getElementById('active-count');
    const inactiveCount = document.getElementById('inactive-count');
    const descCharCount = document.getElementById('desc-char-count');
    const showHideEffortBtn = document.getElementById('show-hide-effort-btn');
    const effortColumnHeader = document.getElementById('effort-column-header');
    const exportBtn = document.getElementById('export-btn');
    const importBtn = document.getElementById('import-btn');
    const importFileInput = document.getElementById('import-file-input');
    const newProjectBtn = document.getElementById('new-project-btn');
    const confirmationModal = document.getElementById('confirmation-modal');
    const confirmNewProject = document.getElementById('confirm-new-project');
    const cancelNewProject = document.getElementById('cancel-new-project');
    const deleteConfirmationModal = document.getElementById('delete-confirmation-modal');
    const confirmDeleteRequirement = document.getElementById('confirm-delete-requirement');
    const cancelDeleteRequirement = document.getElementById('cancel-delete-requirement');
    
    function loadProjectData() {
        const projectName = localStorage.getItem('projectName');
        if (projectName) {
            projectNameDisplay.textContent = projectName;
        }
        
        const savedRequirements = localStorage.getItem('requirements');
        if (savedRequirements) {
            requirements = JSON.parse(savedRequirements);
            initializeRequirementsList();
            updateStatistics();
        }
    }
    
    function saveRequirements() {
        localStorage.setItem('requirements', JSON.stringify(requirements));
    }
    
    editProjectNameBtn.addEventListener('click', function() {
        projectNameDisplay.classList.add('hidden');
        projectNameInput.classList.remove('hidden');
        projectNameInput.value = projectNameDisplay.textContent;
        projectNameInput.focus();
        projectNameInput.select();
    });
    
    projectNameInput.addEventListener('blur', function() {
        saveProjectName();
    });
    
    projectNameInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            saveProjectName();
        }
    });
    
    function saveProjectName() {
        const newName = projectNameInput.value.trim();
        if (newName && newName.length <= 100) {
            projectNameDisplay.textContent = newName;
            localStorage.setItem('projectName', newName);
        } else {
            projectNameInput.value = projectNameDisplay.textContent;
        }
        projectNameInput.classList.add('hidden');
        projectNameDisplay.classList.remove('hidden');
    }
    
    requirementDescription.addEventListener('input', function() {
        descCharCount.textContent = this.value.length;
        hideError('description');
    });
    
    effortValue.addEventListener('input', function() {
        hideError('effort');
    });
    
    addRequirementBtn.addEventListener('click', function() {
        addRequirement();
    });
    
    requirementDescription.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'Enter') {
            addRequirement();
        }
    });
    
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'd') {
            e.preventDefault();
            requirementDescription.focus();
        }
        if (e.ctrlKey && e.key === 'e') {
            e.preventDefault();
            exportData();
        }
    });
    
    function addRequirement() {
        const description = requirementDescription.value.trim();
        const effort = effortValue.value;
        
        let hasError = false;
        
        if (!description) {
            showError('description', 'Requirement description is required');
            hasError = true;
        } else if (/^\s+$/.test(requirementDescription.value)) {
            showError('description', 'Requirement description cannot be empty');
            hasError = true;
        } else if (description.length > 500) {
            showError('description', 'Description cannot exceed 500 characters');
            hasError = true;
        }
        
        if (!effort) {
            showError('effort', 'Effort value is required');
            hasError = true;
        } else if (isNaN(effort) || effort < 0) {
            showError('effort', 'Effort must be a positive number');
            hasError = true;
        } else if (parseFloat(effort) > 9999) {
            showError('effort', 'Effort cannot exceed 9999');
            hasError = true;
        } else if (!/^\d+(\.\d{0,2})?$/.test(effort)) {
            showError('effort', 'Effort can have at most 2 decimal places');
            hasError = true;
        }
        
        if (hasError) return;
        
        const requirement = {
            id: Date.now(),
            description: description,
            effort: parseFloat(effort),
            active: true
        };
        
        requirements.push(requirement);
        saveRequirements();
        
        // Granular update: Add new row
        emptyState.classList.add('hidden');
        const newRowHTML = createRequirementRow(requirement);
        // Insert HTML and get the element
        requirementsTbody.insertAdjacentHTML('beforeend', newRowHTML);
        const newRow = requirementsTbody.lastElementChild;
        
        // Animate in
        requestAnimationFrame(() => {
            newRow.style.opacity = '1';
        });
        
        attachRowEventListeners(newRow);
        updateStatistics();
        
        requirementDescription.value = '';
        effortValue.value = '';
        descCharCount.textContent = '0';
        requirementDescription.focus();
    }
    
    function showError(field, message) {
        const errorDiv = document.getElementById(`${field}-error`);
        const errorText = document.getElementById(`${field}-error-text`);
        errorText.textContent = message;
        errorDiv.classList.remove('hidden');
    }

    function hideError(field) {
        const errorDiv = document.getElementById(`${field}-error`);
        errorDiv.classList.add('hidden');
    }

    // HTML escape function to prevent XSS attacks
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function createRequirementRow(req) {
         return `
            <tr class="group hover:bg-primary-50/50 transition-all duration-200 border-b border-gray-50/50 last:border-0 ${req.active ? '' : 'opacity-60 bg-gray-50/80'}" data-id="${req.id}">
                <td class="px-5 lg:px-6 py-4 align-top w-24">
                    <button class="toggle-status-btn relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 shadow-sm hover:shadow ${req.active ? 'bg-success-500 hover:bg-success-600' : 'bg-gray-300 hover:bg-gray-400'}" role="switch" aria-checked="${req.active}" aria-label="Toggle requirement status">
                        <span class="inline-block h-4 w-4 transform rounded-full bg-white shadow-md transition-transform duration-300 ${req.active ? 'translate-x-6' : 'translate-x-1'}"></span>
                    </button>
                    <div class="requirement-edit hidden mt-2">
                        <span class="text-xs text-gray-400 font-medium ml-1">Editing...</span>
                    </div>
                </td>
                <td class="px-5 lg:px-6 py-4 align-top">
                    <div class="requirement-display">
                        <p class="description-text text-gray-800 font-medium text-sm lg:text-base leading-relaxed break-words">${escapeHtml(req.description)}</p>
                    </div>
                    <div class="requirement-edit hidden w-full">
                        <textarea class="edit-description w-full px-4 py-3 text-sm lg:text-base border-2 border-primary-300 rounded-xl focus:outline-none focus:border-primary-500 focus:ring-4 focus:ring-primary-100 transition-all bg-white shadow-sm resize-none placeholder:text-gray-400" rows="3" maxlength="500" placeholder="Enter requirement description...">${escapeHtml(req.description)}</textarea>
                         <div class="text-xs text-gray-400 mt-1.5 text-right font-medium">
                            <span class="current-char-count">${req.description.length}</span>/500
                        </div>
                    </div>
                </td>
                <td class="px-5 lg:px-6 py-4 effort-cell align-top w-28 ${effortColumnVisible ? '' : 'hidden'}">
                    <div class="requirement-display">
                        <span class="effort-text inline-flex items-center px-3 py-1 bg-accent-100 text-accent-700 font-bold text-sm lg:text-base rounded-lg">${req.effort.toFixed(2)}</span>
                    </div>
                    <div class="requirement-edit hidden w-full">
                         <div class="relative">
                            <input type="number" class="edit-effort w-full pl-3 pr-2 py-2 text-sm lg:text-base border-2 border-accent-300 rounded-xl focus:outline-none focus:border-accent-500 focus:ring-4 focus:ring-accent-100 transition-all bg-white shadow-sm" step="0.01" min="0" max="9999" value="${req.effort}" placeholder="0.00">
                        </div>
                    </div>
                </td>
                <td class="px-5 lg:px-6 py-4 text-right align-top w-40">
                    <div class="requirement-display flex items-center justify-end gap-2 h-full">
                        <button class="edit-btn px-3 py-1.5 bg-white border border-gray-200 hover:border-primary-300 text-gray-600 hover:text-primary-600 rounded-lg transition-all duration-200 flex items-center gap-2 shadow-sm hover:shadow opacity-80 group-hover:opacity-100 transform hover:scale-105 active:scale-95">
                            <i class="fa-solid fa-pen text-xs"></i>
                            <span class="text-xs lg:text-sm font-medium hidden sm:inline">Edit</span>
                        </button>
                        <button class="delete-btn px-3 py-1.5 bg-white border border-gray-200 hover:border-danger-300 text-gray-600 hover:text-danger-600 rounded-lg transition-all duration-200 flex items-center gap-2 shadow-sm hover:shadow opacity-80 group-hover:opacity-100 transform hover:scale-105 active:scale-95">
                            <i class="fa-solid fa-trash text-xs"></i>
                            <span class="text-xs lg:text-sm font-medium hidden sm:inline">Delete</span>
                        </button>
                    </div>
                    <div class="requirement-edit hidden flex-col gap-2 items-end w-full">
                        <button class="save-btn w-full px-3 py-2 bg-success-500 hover:bg-success-600 text-white rounded-lg transition-all duration-200 flex items-center justify-center gap-2 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95">
                            <i class="fa-solid fa-check text-xs"></i>
                            <span class="text-sm font-bold">Save</span>
                        </button>
                        <button class="cancel-btn w-full px-3 py-2 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 shadow-sm hover:shadow">
                            <i class="fa-solid fa-xmark text-xs"></i>
                            <span class="text-sm font-medium">Cancel</span>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    }

    function initializeRequirementsList() {
        if (requirements.length === 0) {
            requirementsTbody.innerHTML = '';
            emptyState.classList.remove('hidden');
            return;
        }

        emptyState.classList.add('hidden');
        requirementsTbody.innerHTML = requirements.map(req => createRequirementRow(req)).join('');
        
        // Attach listeners to all rows
        document.querySelectorAll('#requirements-tbody tr').forEach(row => {
            attachRowEventListeners(row);
        });
    }
    
    function attachRowEventListeners(row) {
        row.querySelector('.toggle-status-btn').addEventListener('click', function(e) {
            e.stopPropagation();
            if (currentEditId !== null) return; // Prevent toggling while editing
            const id = parseInt(row.dataset.id);
            toggleRequirementStatus(id, row);
        });
        
        row.querySelector('.edit-btn').addEventListener('click', function() {
             if (currentEditId !== null) {
                // Determine if we should alert or just close the other one. For now, alert strictly.
                // Or better, cancel the previous edit.
                const prevRow = document.querySelector(`tr[data-id="${currentEditId}"]`);
                if (prevRow) cancelEdit(prevRow);
            }
            const id = parseInt(row.dataset.id);
            startEdit(row, id);
        });
        
        row.querySelector('.delete-btn').addEventListener('click', function() {
            const id = parseInt(row.dataset.id);
            showDeleteConfirmation(id);
        });
        
        row.querySelector('.save-btn').addEventListener('click', function() {
            const id = parseInt(row.dataset.id);
            saveEdit(row, id);
        });
        
        row.querySelector('.cancel-btn').addEventListener('click', function() {
            cancelEdit(row);
        });

        // Live char count for edit description
        const editDescInput = row.querySelector('.edit-description');
        const charCountDisplay = row.querySelector('.current-char-count');
        if(editDescInput && charCountDisplay) {
            editDescInput.addEventListener('input', function() {
                charCountDisplay.textContent = this.value.length;
            });
        }
    }
    
    function toggleRequirementStatus(id, row) {
        const req = requirements.find(r => r.id === id);
        if (req) {
            req.active = !req.active;
            saveRequirements();
            
            // Granular DOM update
            const toggleBtn = row.querySelector('.toggle-status-btn');
            const toggleKnob = toggleBtn.querySelector('span');
            
            if (req.active) {
                // Set active state
                toggleBtn.classList.remove('bg-gray-300', 'hover:bg-gray-400');
                toggleBtn.classList.add('bg-success-500', 'hover:bg-success-600');
                toggleBtn.setAttribute('aria-checked', 'true');
                
                toggleKnob.classList.remove('translate-x-1');
                toggleKnob.classList.add('translate-x-6');
                
                row.classList.remove('opacity-60', 'bg-gray-50/80');
            } else {
                // Set inactive state
                toggleBtn.classList.remove('bg-success-500', 'hover:bg-success-600');
                toggleBtn.classList.add('bg-gray-300', 'hover:bg-gray-400');
                toggleBtn.setAttribute('aria-checked', 'false');
                
                toggleKnob.classList.remove('translate-x-6');
                toggleKnob.classList.add('translate-x-1');
                
                row.classList.add('opacity-60', 'bg-gray-50/80');
            }
            
            updateStatistics();
        }
    }
    
    function startEdit(row, id) {
        // Highlight row
        row.classList.add('bg-primary-50', 'ring-2', 'ring-inset', 'ring-primary-200', 'z-10');
        row.classList.remove('hover:bg-primary-50/50'); // Remove hover effect while editing

        row.querySelectorAll('.requirement-display').forEach(el => el.classList.add('hidden'));
        row.querySelectorAll('.requirement-edit').forEach(el => el.classList.remove('hidden', 'flex'));
        row.querySelectorAll('.requirement-edit.flex-col').forEach(el => el.classList.add('flex')); // Ensure flex column for buttons
        
        
        const descInput = row.querySelector('.edit-description');
        if (descInput) {
             descInput.focus();
             // Cursor at end
             const val = descInput.value;
             descInput.value = '';
             descInput.value = val;
        }

        currentEditId = id;
    }
    
    // Add enter key support for saving edit
    /* 
    // Commented out to avoid accidental saves on multiline description
    document.addEventListener('keydown', function(e) {
        if (currentEditId !== null && e.ctrlKey && e.key === 'Enter') {
             const row = document.querySelector(`tr[data-id="${currentEditId}"]`);
             if(row) saveEdit(row, currentEditId);
        }
    }); 
    */
    
    function cancelEdit(row) {
        // Remove highlight
        row.classList.remove('bg-primary-50', 'ring-2', 'ring-inset', 'ring-primary-200', 'z-10');
        row.classList.add('hover:bg-primary-50/50');

        row.querySelectorAll('.requirement-edit').forEach(el => el.classList.add('hidden'));
        row.querySelectorAll('.requirement-edit').forEach(el => el.classList.remove('flex'));
        row.querySelectorAll('.requirement-display').forEach(el => el.classList.remove('hidden'));
        
        // Reset values
        const id = parseInt(row.dataset.id);
        const req = requirements.find(r => r.id === id);
        if (req) {
            row.querySelector('.edit-description').value = req.description;
            row.querySelector('.edit-effort').value = req.effort;
            const charCount = row.querySelector('.current-char-count');
            if(charCount) charCount.textContent = req.description.length;
        }

        currentEditId = null;
    }
    
    function saveEdit(row, id) {
        const newDescription = row.querySelector('.edit-description').value.trim();
        const newEffort = row.querySelector('.edit-effort').value;
        
        if (!newDescription || newDescription.length > 500) {
            alert('Invalid description');
            // Better: Show error in UI, but sticky alert is simple for now or we could add error element in createRow
            return;
        }
        
        if (!newEffort || isNaN(newEffort) || parseFloat(newEffort) < 0 || parseFloat(newEffort) > 9999) {
            alert('Invalid effort value');
            return;
        }
        
        const req = requirements.find(r => r.id === id);
        if (req) {
            req.description = newDescription;
            req.effort = parseFloat(newEffort);
            saveRequirements();
            
            // Granular DOM update
            row.querySelector('.description-text').textContent = newDescription;
            row.querySelector('.effort-text').textContent = req.effort.toFixed(2);
            // row.querySelector('.edit-description').textContent = newDescription; // No need as value is set on open
            
            cancelEdit(row); // Use cancel to switch back to view mode and clean up classes
            
            updateStatistics();
        }
    }    

    
    function showDeleteConfirmation(id) {
        currentDeleteId = id;
        deleteConfirmationModal.style.display = 'flex';
    }

    confirmDeleteRequirement.addEventListener('click', function() {
        if (currentDeleteId !== null) {
            requirements = requirements.filter(r => r.id !== currentDeleteId);
            saveRequirements();
            
            // Granular DOM update
            const rowView = document.querySelector(`tr[data-id="${currentDeleteId}"]`);
            if (rowView) {
                rowView.remove();
            }
            
            if (requirements.length === 0) {
                 emptyState.classList.remove('hidden');
            }
            
            updateStatistics();

            // Close the modal
            deleteConfirmationModal.style.display = 'none';
            currentDeleteId = null;
        }
    });

    cancelDeleteRequirement.addEventListener('click', function() {
        currentDeleteId = null;
        deleteConfirmationModal.style.display = 'none';
    });
    
    function updateStatistics() {
        const activeReqs = requirements.filter(r => r.active);
        const totalEffort = activeReqs.reduce((sum, r) => sum + r.effort, 0);

        totalEffortDisplay.textContent = totalEffort.toFixed(2);
        totalRequirementsCount.textContent = requirements.length;
        activeCount.textContent = activeReqs.length;
        inactiveCount.textContent = requirements.length - activeReqs.length;
    }
    
    showHideEffortBtn.addEventListener('click', function() {
        effortColumnVisible = !effortColumnVisible;
        updateEffortVisibility();
    });
    
    exportBtn.addEventListener('click', function() {
        exportData();
    });
    
    function exportData() {
        const projectName = localStorage.getItem('projectName') || 'project';
        const data = {
            projectName: projectName,
            requirements: requirements,
            exportDate: new Date().toISOString()
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${projectName.replace(/\s+/g, '_')}_requirements.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }
    
    importBtn.addEventListener('click', function() {
        importFileInput.click();
    });
    
    importFileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(event) {
            try {
                const data = JSON.parse(event.target.result);
                if (data.projectName && data.requirements) {
                    localStorage.setItem('projectName', data.projectName);
                    projectNameDisplay.textContent = data.projectName;
                    requirements = data.requirements;
                    saveRequirements();
                    renderRequirements();
                    updateStatistics();
                    alert('Import successful!');
                } else {
                    alert('Invalid file format');
                }
            } catch (error) {
                alert('Error reading file');
            }
        };
        reader.readAsText(file);
        importFileInput.value = '';
    });
    
    newProjectBtn.addEventListener('click', function() {
        confirmationModal.classList.remove('hidden');
        confirmationModal.classList.add('flex');
    });

    confirmNewProject.addEventListener('click', function() {
        localStorage.removeItem('projectName');
        localStorage.removeItem('projectCreated');
        localStorage.removeItem('requirements');
        window.location.href = 'index.html';
    });

    cancelNewProject.addEventListener('click', function() {
        confirmationModal.classList.add('hidden');
        confirmationModal.classList.remove('flex');
    });

    // Mobile menu toggle
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileActions = document.getElementById('mobile-actions');

    if (mobileMenuBtn && mobileActions) {
        mobileMenuBtn.addEventListener('click', function() {
            mobileActions.classList.toggle('hidden');
        });

        // Mobile button handlers - duplicate functionality from desktop
        const showHideEffortBtnMobile = document.getElementById('show-hide-effort-btn-mobile');
        const exportBtnMobile = document.getElementById('export-btn-mobile');
        const importBtnMobile = document.getElementById('import-btn-mobile');
        const newProjectBtnMobile = document.getElementById('new-project-btn-mobile');

        if (showHideEffortBtnMobile) {
            showHideEffortBtnMobile.addEventListener('click', function() {
                effortColumnVisible = !effortColumnVisible;
                updateEffortVisibility();
            });
        }

        if (exportBtnMobile) {
            exportBtnMobile.addEventListener('click', exportData);
        }

        if (importBtnMobile) {
            importBtnMobile.addEventListener('click', function() {
                importFileInput.click();
            });
        }

        if (newProjectBtnMobile) {
            newProjectBtnMobile.addEventListener('click', function() {
                confirmationModal.classList.remove('hidden');
                confirmationModal.classList.add('flex');
            });
        }
    }

    // Helper function to update effort visibility
    function updateEffortVisibility() {
        if (effortColumnVisible) {
            effortColumnHeader.classList.remove('hidden');
            document.querySelectorAll('.effort-cell').forEach(cell => cell.classList.remove('hidden'));
            
            // Desktop button update
            showHideEffortBtn.querySelector('.fa-eye').classList.remove('hidden');
            showHideEffortBtn.querySelector('.fa-eye-slash').classList.add('hidden');
            showHideEffortBtn.querySelector('span').textContent = 'Hide Effort';
            
            // Mobile button update
            const mobileBtn = document.getElementById('show-hide-effort-btn-mobile');
            if (mobileBtn) {
                mobileBtn.querySelector('.fa-eye').classList.remove('hidden');
                mobileBtn.querySelector('.fa-eye-slash').classList.add('hidden');
                mobileBtn.querySelector('span').textContent = 'Hide Effort';
            }
        } else {
            effortColumnHeader.classList.add('hidden');
            document.querySelectorAll('.effort-cell').forEach(cell => cell.classList.add('hidden'));
            
            // Desktop button update
            showHideEffortBtn.querySelector('.fa-eye').classList.add('hidden');
            showHideEffortBtn.querySelector('.fa-eye-slash').classList.remove('hidden');
            showHideEffortBtn.querySelector('span').textContent = 'Show Effort';
            
            // Mobile button update
            const mobileBtn = document.getElementById('show-hide-effort-btn-mobile');
            if (mobileBtn) {
                mobileBtn.querySelector('.fa-eye').classList.add('hidden');
                mobileBtn.querySelector('.fa-eye-slash').classList.remove('hidden');
                mobileBtn.querySelector('span').textContent = 'Show Effort';
            }
        }
    }

    // Helper functions for closing modals
    function closeConfirmationModal() {
        confirmationModal.classList.add('hidden');
        confirmationModal.classList.remove('flex');
    }

    function closeDeleteModal() {
        deleteConfirmationModal.style.display = 'none';
        currentDeleteId = null;
    }

    // Keyboard accessibility - Close modals with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            // Close delete confirmation modal if open
            if (deleteConfirmationModal.style.display === 'flex') {
                closeDeleteModal();
            }
            // Close new project confirmation modal if open
            if (!confirmationModal.classList.contains('hidden')) {
                closeConfirmationModal();
            }
            // Close mobile menu if open
            if (mobileActions && !mobileActions.classList.contains('hidden')) {
                mobileActions.classList.add('hidden');
            }
        }
    });

    // Close modals when clicking on backdrop
    confirmationModal.addEventListener('click', function(e) {
        if (e.target === confirmationModal) {
            closeConfirmationModal();
        }
    });

    deleteConfirmationModal.addEventListener('click', function(e) {
        if (e.target === deleteConfirmationModal) {
            closeDeleteModal();
        }
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
        if (mobileActions && !mobileActions.classList.contains('hidden')) {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            if (!mobileActions.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                mobileActions.classList.add('hidden');
            }
        }
    });

    loadProjectData();
        // Initialize the app with granularity
        initializeRequirementsList();
        updateStatistics();
    });
    </script>
</body>
</html>